<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Paiement - Debug</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .box {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        button {
            background: #5F9E7F;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #4a7d63;
        }
    </style>
</head>
<body>
    <h1>üîç Diagnostic Syst√®me de Paiement</h1>
    
    <div class="box">
        <h2>1. V√©rification des fichiers</h2>
        <div id="fichiers-check"></div>
    </div>
    
    <div class="box">
        <h2>2. V√©rification localStorage</h2>
        <div id="localstorage-check"></div>
        <button onclick="afficherLocalStorage()">Afficher localStorage</button>
        <button onclick="testerDonnees()">Cr√©er donn√©es test</button>
        <button onclick="nettoyerLocalStorage()">Nettoyer</button>
    </div>
    
    <div class="box">
        <h2>3. Test redirection</h2>
        <button onclick="window.location.href='paiement.html'">Aller √† paiement.html</button>
        <button onclick="window.open('paiement.html', '_blank')">Ouvrir dans nouvel onglet</button>
    </div>
    
    <div class="box">
        <h2>4. V√©rification console</h2>
        <p>Ouvrez la console (F12) pour voir les erreurs JavaScript</p>
        <button onclick="testConsole()">Test console</button>
    </div>
    
    <div class="box">
        <h2>5. Donn√©es panierCheckout</h2>
        <pre id="panier-data"></pre>
    </div>

    <script>
        // V√©rification des fichiers
        async function verifierFichiers() {
            const fichiers = [
                'paiement.html',
                '../back/assets/js/paiement.js',
                '../back/assets/css/style-front.css'
            ];
            
            const div = document.getElementById('fichiers-check');
            let html = '';
            
            for (const fichier of fichiers) {
                try {
                    const response = await fetch(fichier, { method: 'HEAD' });
                    if (response.ok) {
                        html += `<p class="success">‚úì ${fichier} - OK</p>`;
                    } else {
                        html += `<p class="error">‚úó ${fichier} - Erreur ${response.status}</p>`;
                    }
                } catch (error) {
                    html += `<p class="error">‚úó ${fichier} - ${error.message}</p>`;
                }
            }
            
            div.innerHTML = html;
        }
        
        // Afficher localStorage
        function afficherLocalStorage() {
            const div = document.getElementById('localstorage-check');
            const panierCheckout = localStorage.getItem('panierCheckout');
            
            if (panierCheckout) {
                try {
                    const data = JSON.parse(panierCheckout);
                    div.innerHTML = `
                        <p class="success">‚úì panierCheckout trouv√©</p>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
                    document.getElementById('panier-data').textContent = JSON.stringify(data, null, 2);
                } catch (e) {
                    div.innerHTML = `<p class="error">‚úó Erreur parsing JSON: ${e.message}</p>`;
                }
            } else {
                div.innerHTML = `<p class="warning">‚ö† panierCheckout non trouv√© dans localStorage</p>`;
            }
        }
        
        // Cr√©er donn√©es test
        function testerDonnees() {
            const testData = {
                client: {
                    nom: 'Dhia Eddin Hamdouni',
                    email: 'hamdounidhiaeddine@gmail.com',
                    telephone: '06 12 34 56 78',
                    adresse: '123 Rue de Test, 75001 Paris'
                },
                articles: [
                    {
                        id: 1,
                        nom: 'Produit Test',
                        prix: 29.99,
                        quantite: 2,
                        sous_total: 59.98
                    }
                ],
                total: 59.98,
                count: 1
            };
            
            localStorage.setItem('panierCheckout', JSON.stringify(testData));
            document.getElementById('localstorage-check').innerHTML = 
                '<p class="success">‚úì Donn√©es test cr√©√©es</p>';
            afficherLocalStorage();
        }
        
        // Nettoyer localStorage
        function nettoyerLocalStorage() {
            localStorage.removeItem('panierCheckout');
            document.getElementById('localstorage-check').innerHTML = 
                '<p class="success">‚úì localStorage nettoy√©</p>';
            document.getElementById('panier-data').textContent = '';
        }
        
        // Test console
        function testConsole() {
            console.log('‚úì Test console OK');
            console.log('panierCheckout:', localStorage.getItem('panierCheckout'));
            alert('Regardez la console (F12)');
        }
        
        // Ex√©cuter au chargement
        window.addEventListener('load', () => {
            verifierFichiers();
            afficherLocalStorage();
        });
    </script>
</body>
</html>
